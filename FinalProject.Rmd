Catherine Heller
Jeremy Hess
Rudra Menon

Final Project CMSC320 2019

```{r libraries, ECHO=FALSE}
library(magrittr)
library(rvest)
library(tidyr)
library(ggplot2)
library(dplyr)
library(tidyverse)
library(plotly)
```



```{r part 1, RESULTS=HIDE}
stats <- read_csv("SpaceBastards-stats.csv")

stats <- stats %>%
  select("Date/Time", tournament = "Tournamemnt", opponent = "Opponent", time = "Point Elapsed Seconds", "Line", 
         ourscore = "Our Score - End of Point", theirscore = "Their Score - End of Point", "Event Type", "Action", 
         "Passer", rec = "Receiver", "Defender", p0 = "Player 0", p1 = "Player 1", p2 = "Player 2", p3 = "Player 3", p4 = "Player 4",
         p5 = "Player 5", p6 = "Player 6")

stats


```

```{r part 2}
plusminus <- stats
plusminus$Player <- ifelse(is.na(plusminus$Passer), plusminus$Defender,
                           ifelse(plusminus$Action == "Drop", plusminus$rec, plusminus$Passer))

plusminus <- plusminus %>% rbind(plusminus %>%
                                   filter(Action=="Goal") %>%
                                   mutate(Action="Score", Player=rec))
plusminus <- plusminus %>%
  select(Player, Action, rec) %>%
  group_by(Player) %>%
  count(Action) %>%
  select(Player, Action, n)

rows <- dim(plusminus)[1]; plusminus <- plusminus[1:(rows - 6),] #Remove last 6 entries, not useful
plusminus <- plusminus%>% 
  group_by(Player) %>%
  spread(key="Action",value=n)
plusminus[is.na(plusminus)] <- 0

plusminus
  
```
```{r part 3}
plusminus %>% select(Player, "Catch", "Goal", "Throwaway", "Stall")
```

```{r part 4}
points <- stats %>%
  select(tournament, opponent, ourscore, theirscore, p0, p1, p2, p3, p4, p5, p6) %>%
  group_by(tournament, opponent, ourscore, theirscore, p0, p1, p2, p3, p4, p5 ,p6) %>%
  count()
#TEMPLATE FOR COUNTING POINTS
points_played <- data.frame()


for (num in c("p0", "p1", "p2", "p3", "p4", "p5", "p6")) {
  curr <- points %>%
  select(num) %>%
  group_by(paste(num)) %>%
  count() 
  points_played <- bind_rows(points_played, curr)
}

points %>% group_by("p0")

```

``` {r part 5}
final_df <- rbind.fill(plusminus, points_played)%>% 
  group_by(Player) %>%
  summarise_all(funs(first(na.omit(.)))) %>% 
  filter(Player != "0" &  Player != "Anonymous")

plot <-final_df %>% ggplot(mapping = aes(label=Player, x=plusminus, y=freq)) +
  geom_point()+ 
  geom_smooth(method=lm) 


ggplotly(plot, tooltip = c("Player"))

```
